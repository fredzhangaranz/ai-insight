{
  "ReportVersion": "2024.2.6",
  "ReportGuid": "bf170ca5-750c-3341-713a-681db10e276c",
  "ReportName": "WCPUserActivity",
  "ReportAlias": "WCPUserActivity",
  "ReportCreated": "/Date(1734032086000+1300)/",
  "ReportChanged": "/Date(1736119000000+1300)/",
  "EngineVersion": "EngineV2",
  "CalculationMode": "Interpretation",
  "ReportUnit": "Centimeters",
  "Styles": {
    "0": {
      "Ident": "StiChartStyle",
      "Description": "Style based on formating of ChartElement1 component",
      "Name": "Style1",
      "Border": ";;;;;;;solid:0,0,0",
      "Brush": "solid:245,245,245",
      "BrushType": "Solid",
      "StyleColors": {
        "0": "64,86,141",
        "1": "69,105,187",
        "2": "228,115,52",
        "3": "157,156,156",
        "4": "248,185,45",
        "5": "94,147,204",
        "6": "110,165,72"
      },
      "BasicStyleColor": "233,244,252",
      "ChartAreaBrush": "solid:242,245,252",
      "ChartAreaBorderColor": "83,94,102",
      "SeriesLabelsBrush": "solid:119,255,255,255",
      "SeriesLabelsColor": "233,244,252",
      "SeriesLabelsBorderColor": "Transparent",
      "SeriesShowBorder": true,
      "LegendBrush": "solid:",
      "LegendLabelsColor": "233,244,252",
      "LegendBorderColor": "Transparent",
      "LegendTitleColor": "233,244,252",
      "AxisTitleColor": "233,244,252",
      "AxisLineColor": "233,244,252",
      "AxisLabelsColor": "233,244,252",
      "MarkerVisible": false,
      "InterlacingHorBrush": "solid:10,133,144,152",
      "InterlacingVertBrush": "solid:10,133,144,152",
      "GridLinesHorColor": "233,244,252",
      "GridLinesVertColor": "233,244,252",
      "SeriesCornerRadius": "0, 0, 0, 0",
      "ToolTipBrush": "solid:180,50,50,50",
      "ToolTipTextBrush": "solid:255,255,255",
      "ToolTipCornerRadius": "8, 8, 8, 8",
      "ToolTipBorder": ";;;;"
    }
  },
  "Dictionary": {
    "DataSources": {
      "0": {
        "Ident": "StiSqlSource",
        "Name": "rpt.Assessment",
        "Alias": "rpt.Assessment",
        "Columns": {
          "0": {
            "Name": "assessmentTypeVersionFk",
            "NameInSource": "assessmentTypeVersionFk",
            "Alias": "assessmentTypeVersionFk",
            "Type": "System.String"
          },
          "1": {
            "Name": "createdByUserFk",
            "NameInSource": "createdByUserFk",
            "Alias": "createdByUserFk",
            "Type": "System.String"
          },
          "2": {
            "Name": "createdByUserName",
            "NameInSource": "createdByUserName",
            "Alias": "createdByUserName",
            "Type": "System.String"
          },
          "3": {
            "Name": "date",
            "NameInSource": "date",
            "Alias": "date",
            "Type": "System.DateTimeOffset"
          },
          "4": {
            "Name": "dimDateFk",
            "NameInSource": "dimDateFk",
            "Alias": "dimDateFk",
            "Type": "System.Int32"
          },
          "5": {
            "Name": "id",
            "NameInSource": "id",
            "Alias": "id",
            "Type": "System.String"
          },
          "6": {
            "Name": "patientFk",
            "NameInSource": "patientFk",
            "Alias": "patientFk",
            "Type": "System.String"
          },
          "7": {
            "Name": "signedByUserFk",
            "NameInSource": "signedByUserFk",
            "Alias": "signedByUserFk",
            "Type": "System.String"
          },
          "8": {
            "Name": "signedByUserName",
            "NameInSource": "signedByUserName",
            "Alias": "signedByUserName",
            "Type": "System.String"
          },
          "9": {
            "Name": "timeZoneId",
            "NameInSource": "timeZoneId",
            "Alias": "timeZoneId",
            "Type": "System.String"
          },
          "10": {
            "Name": "unitFk",
            "NameInSource": "unitFk",
            "Alias": "unitFk",
            "Type": "System.String"
          },
          "11": {
            "Name": "woundFk",
            "NameInSource": "woundFk",
            "Alias": "woundFk",
            "Type": "System.String"
          }
        },
        "NameInSource": "Connection",
        "SqlCommand": "select * from rpt.Assessment"
      },
      "1": {
        "Ident": "StiSqlSource",
        "Name": "rpt.AssessmentTypeVersion",
        "Alias": "rpt.AssessmentTypeVersion",
        "Columns": {
          "0": {
            "Name": "assessmentTypeId",
            "NameInSource": "assessmentTypeId",
            "Alias": "assessmentTypeId",
            "Type": "System.String"
          },
          "1": {
            "Name": "definitionVersion",
            "NameInSource": "definitionVersion",
            "Alias": "definitionVersion",
            "Type": "System.Int32"
          },
          "2": {
            "Name": "id",
            "NameInSource": "id",
            "Alias": "id",
            "Type": "System.String"
          },
          "3": {
            "Name": "name",
            "NameInSource": "name",
            "Alias": "name",
            "Type": "System.String"
          },
          "4": {
            "Name": "orderIndex",
            "NameInSource": "orderIndex",
            "Alias": "orderIndex",
            "Type": "System.Int32"
          },
          "5": {
            "Name": "type",
            "NameInSource": "type",
            "Alias": "type",
            "Type": "System.Int32"
          }
        },
        "NameInSource": "Connection",
        "SqlCommand": "select * from rpt.AssessmentTypeVersion"
      },
      "2": {
        "Ident": "StiSqlSource",
        "Name": "rpt.AttributeType",
        "Alias": "rpt.AttributeType",
        "Columns": {
          "0": {
            "Name": "attributeTypeKey",
            "NameInSource": "attributeTypeKey",
            "Alias": "attributeTypeKey",
            "Type": "System.String"
          },
          "1": {
            "Name": "dataType",
            "NameInSource": "dataType",
            "Alias": "dataType",
            "Type": "System.Int32"
          },
          "2": {
            "Name": "id",
            "NameInSource": "id",
            "Alias": "id",
            "Type": "System.String"
          },
          "3": {
            "Name": "name",
            "NameInSource": "name",
            "Alias": "name",
            "Type": "System.String"
          },
          "4": {
            "Name": "orderIndex",
            "NameInSource": "orderIndex",
            "Alias": "orderIndex",
            "Type": "System.Int32"
          },
          "5": {
            "Name": "variableName",
            "NameInSource": "variableName",
            "Alias": "variableName",
            "Type": "System.String"
          }
        },
        "NameInSource": "Connection",
        "SqlCommand": "select * from rpt.AttributeType"
      },
      "3": {
        "Ident": "StiSqlSource",
        "Name": "rpt.DimDate",
        "Alias": "rpt.DimDate",
        "Columns": {
          "0": {
            "Name": "date",
            "NameInSource": "date",
            "Alias": "date",
            "Type": "System.DateTime"
          },
          "1": {
            "Name": "dayOfMonth",
            "NameInSource": "dayOfMonth",
            "Alias": "dayOfMonth",
            "Type": "System.Int32"
          },
          "2": {
            "Name": "dayOfWeek",
            "NameInSource": "dayOfWeek",
            "Alias": "dayOfWeek",
            "Type": "System.Int32"
          },
          "3": {
            "Name": "dayOfYear",
            "NameInSource": "dayOfYear",
            "Alias": "dayOfYear",
            "Type": "System.Int32"
          },
          "4": {
            "Name": "firstOfMonth",
            "NameInSource": "firstOfMonth",
            "Alias": "firstOfMonth",
            "Type": "System.DateTime"
          },
          "5": {
            "Name": "id",
            "NameInSource": "id",
            "Alias": "id",
            "Type": "System.Int32"
          },
          "6": {
            "Name": "month",
            "NameInSource": "month",
            "Alias": "month",
            "Type": "System.Int32"
          },
          "7": {
            "Name": "quarter",
            "NameInSource": "quarter",
            "Alias": "quarter",
            "Type": "System.Int32"
          },
          "8": {
            "Name": "weekOfYear",
            "NameInSource": "weekOfYear",
            "Alias": "weekOfYear",
            "Type": "System.Int32"
          },
          "9": {
            "Name": "year",
            "NameInSource": "year",
            "Alias": "year",
            "Type": "System.Int32"
          }
        },
        "NameInSource": "Connection",
        "SqlCommand": "select * from rpt.DimDate"
      },
      "4": {
        "Ident": "StiSqlSource",
        "Name": "rpt.Measurement",
        "Alias": "rpt.Measurement",
        "Columns": {
          "0": {
            "Name": "area",
            "NameInSource": "area",
            "Alias": "area",
            "Type": "System.Object"
          },
          "1": {
            "Name": "areaReduction",
            "NameInSource": "areaReduction",
            "Alias": "areaReduction",
            "Type": "System.Object"
          },
          "2": {
            "Name": "assessmentFk",
            "NameInSource": "assessmentFk",
            "Alias": "assessmentFk",
            "Type": "System.String"
          },
          "3": {
            "Name": "attributeTypeFk",
            "NameInSource": "attributeTypeFk",
            "Alias": "attributeTypeFk",
            "Type": "System.String"
          },
          "4": {
            "Name": "depth",
            "NameInSource": "depth",
            "Alias": "depth",
            "Type": "System.Object"
          },
          "5": {
            "Name": "dimDateFk",
            "NameInSource": "dimDateFk",
            "Alias": "dimDateFk",
            "Type": "System.Int32"
          },
          "6": {
            "Name": "id",
            "NameInSource": "id",
            "Alias": "id",
            "Type": "System.String"
          },
          "7": {
            "Name": "imageCount",
            "NameInSource": "imageCount",
            "Alias": "imageCount",
            "Type": "System.Int32"
          },
          "8": {
            "Name": "islandCount",
            "NameInSource": "islandCount",
            "Alias": "islandCount",
            "Type": "System.Int32"
          },
          "9": {
            "Name": "length",
            "NameInSource": "length",
            "Alias": "length",
            "Type": "System.Object"
          },
          "10": {
            "Name": "outlineCount",
            "NameInSource": "outlineCount",
            "Alias": "outlineCount",
            "Type": "System.Int32"
          },
          "11": {
            "Name": "patientFk",
            "NameInSource": "patientFk",
            "Alias": "patientFk",
            "Type": "System.String"
          },
          "12": {
            "Name": "perimeter",
            "NameInSource": "perimeter",
            "Alias": "perimeter",
            "Type": "System.Object"
          },
          "13": {
            "Name": "unitFk",
            "NameInSource": "unitFk",
            "Alias": "unitFk",
            "Type": "System.String"
          },
          "14": {
            "Name": "volume",
            "NameInSource": "volume",
            "Alias": "volume",
            "Type": "System.Object"
          },
          "15": {
            "Name": "width",
            "NameInSource": "width",
            "Alias": "width",
            "Type": "System.Object"
          },
          "16": {
            "Name": "woundFk",
            "NameInSource": "woundFk",
            "Alias": "woundFk",
            "Type": "System.String"
          }
        },
        "NameInSource": "Connection",
        "SqlCommand": "select * from rpt.Measurement"
      },
      "5": {
        "Ident": "StiSqlSource",
        "Name": "rpt.Note",
        "Alias": "rpt.Note",
        "Columns": {
          "0": {
            "Name": "assessmentFk",
            "NameInSource": "assessmentFk",
            "Alias": "assessmentFk",
            "Type": "System.String"
          },
          "1": {
            "Name": "attributeTypeFk",
            "NameInSource": "attributeTypeFk",
            "Alias": "attributeTypeFk",
            "Type": "System.String"
          },
          "2": {
            "Name": "dimDateFk",
            "NameInSource": "dimDateFk",
            "Alias": "dimDateFk",
            "Type": "System.Int32"
          },
          "3": {
            "Name": "id",
            "NameInSource": "id",
            "Alias": "id",
            "Type": "System.String"
          },
          "4": {
            "Name": "patientFk",
            "NameInSource": "patientFk",
            "Alias": "patientFk",
            "Type": "System.String"
          },
          "5": {
            "Name": "unitFk",
            "NameInSource": "unitFk",
            "Alias": "unitFk",
            "Type": "System.String"
          },
          "6": {
            "Name": "value",
            "NameInSource": "value",
            "Alias": "value",
            "Type": "System.String"
          },
          "7": {
            "Name": "valueBoolean",
            "NameInSource": "valueBoolean",
            "Alias": "valueBoolean",
            "Type": "System.Boolean"
          },
          "8": {
            "Name": "valueDate",
            "NameInSource": "valueDate",
            "Alias": "valueDate",
            "Type": "System.DateTime"
          },
          "9": {
            "Name": "valueDecimal",
            "NameInSource": "valueDecimal",
            "Alias": "valueDecimal",
            "Type": "System.Decimal"
          },
          "10": {
            "Name": "valueInt",
            "NameInSource": "valueInt",
            "Alias": "valueInt",
            "Type": "System.Int32"
          },
          "11": {
            "Name": "woundFk",
            "NameInSource": "woundFk",
            "Alias": "woundFk",
            "Type": "System.String"
          },
          "12": {
            "Name": "woundStateFk",
            "NameInSource": "woundStateFk",
            "Alias": "woundStateFk",
            "Type": "System.String"
          }
        },
        "NameInSource": "Connection",
        "SqlCommand": "select * from rpt.Note"
      },
      "6": {
        "Ident": "StiSqlSource",
        "Name": "rpt.Patient",
        "Alias": "rpt.Patient",
        "Columns": {
          "0": {
            "Name": "addressCity",
            "NameInSource": "addressCity",
            "Alias": "addressCity",
            "Type": "System.String"
          },
          "1": {
            "Name": "addressCountry",
            "NameInSource": "addressCountry",
            "Alias": "addressCountry",
            "Type": "System.String"
          },
          "2": {
            "Name": "addressPostcode",
            "NameInSource": "addressPostcode",
            "Alias": "addressPostcode",
            "Type": "System.String"
          },
          "3": {
            "Name": "addressState",
            "NameInSource": "addressState",
            "Alias": "addressState",
            "Type": "System.String"
          },
          "4": {
            "Name": "addressStreet",
            "NameInSource": "addressStreet",
            "Alias": "addressStreet",
            "Type": "System.String"
          },
          "5": {
            "Name": "addressSuburb",
            "NameInSource": "addressSuburb",
            "Alias": "addressSuburb",
            "Type": "System.String"
          },
          "6": {
            "Name": "dateOfBirth",
            "NameInSource": "dateOfBirth",
            "Alias": "dateOfBirth",
            "Type": "System.DateTime"
          },
          "7": {
            "Name": "domainId",
            "NameInSource": "domainId",
            "Alias": "domainId",
            "Type": "System.String"
          },
          "8": {
            "Name": "firstName",
            "NameInSource": "firstName",
            "Alias": "firstName",
            "Type": "System.String"
          },
          "9": {
            "Name": "gender",
            "NameInSource": "gender",
            "Alias": "gender",
            "Type": "System.String"
          },
          "10": {
            "Name": "homePhone",
            "NameInSource": "homePhone",
            "Alias": "homePhone",
            "Type": "System.String"
          },
          "11": {
            "Name": "id",
            "NameInSource": "id",
            "Alias": "id",
            "Type": "System.String"
          },
          "12": {
            "Name": "lastName",
            "NameInSource": "lastName",
            "Alias": "lastName",
            "Type": "System.String"
          },
          "13": {
            "Name": "middleName",
            "NameInSource": "middleName",
            "Alias": "middleName",
            "Type": "System.String"
          },
          "14": {
            "Name": "mobilePhone",
            "NameInSource": "mobilePhone",
            "Alias": "mobilePhone",
            "Type": "System.String"
          },
          "15": {
            "Name": "unitFk",
            "NameInSource": "unitFk",
            "Alias": "unitFk",
            "Type": "System.String"
          },
          "16": {
            "Name": "workPhone",
            "NameInSource": "workPhone",
            "Alias": "workPhone",
            "Type": "System.String"
          }
        },
        "NameInSource": "Connection",
        "SqlCommand": "select * from rpt.Patient"
      },
      "7": {
        "Ident": "StiSqlSource",
        "Name": "rpt.Unit",
        "Alias": "rpt.Unit",
        "Columns": {
          "0": {
            "Name": "id",
            "NameInSource": "id",
            "Alias": "id",
            "Type": "System.String"
          },
          "1": {
            "Name": "name",
            "NameInSource": "name",
            "Alias": "name",
            "Type": "System.String"
          }
        },
        "NameInSource": "Connection",
        "SqlCommand": "select * from rpt.Unit"
      },
      "8": {
        "Ident": "StiSqlSource",
        "Name": "rpt.Wound",
        "Alias": "rpt.Wound",
        "Columns": {
          "0": {
            "Name": "anatomyLabel",
            "NameInSource": "anatomyLabel",
            "Alias": "anatomyLabel",
            "Type": "System.String"
          },
          "1": {
            "Name": "auxText",
            "NameInSource": "auxText",
            "Alias": "auxText",
            "Type": "System.String"
          },
          "2": {
            "Name": "baselineDate",
            "NameInSource": "baselineDate",
            "Alias": "baselineDate",
            "Type": "System.DateTime"
          },
          "3": {
            "Name": "baselineDimDateFk",
            "NameInSource": "baselineDimDateFk",
            "Alias": "baselineDimDateFk",
            "Type": "System.Int32"
          },
          "4": {
            "Name": "description",
            "NameInSource": "description",
            "Alias": "description",
            "Type": "System.String"
          },
          "5": {
            "Name": "id",
            "NameInSource": "id",
            "Alias": "id",
            "Type": "System.String"
          },
          "6": {
            "Name": "index",
            "NameInSource": "index",
            "Alias": "index",
            "Type": "System.Int32"
          },
          "7": {
            "Name": "label",
            "NameInSource": "label",
            "Alias": "label",
            "Type": "System.String"
          },
          "8": {
            "Name": "level0AnatomyId",
            "NameInSource": "level0AnatomyId",
            "Alias": "level0AnatomyId",
            "Type": "System.String"
          },
          "9": {
            "Name": "level0Text",
            "NameInSource": "level0Text",
            "Alias": "level0Text",
            "Type": "System.String"
          },
          "10": {
            "Name": "level1AnatomyId",
            "NameInSource": "level1AnatomyId",
            "Alias": "level1AnatomyId",
            "Type": "System.String"
          },
          "11": {
            "Name": "level1Text",
            "NameInSource": "level1Text",
            "Alias": "level1Text",
            "Type": "System.String"
          },
          "12": {
            "Name": "level2AnatomyId",
            "NameInSource": "level2AnatomyId",
            "Alias": "level2AnatomyId",
            "Type": "System.String"
          },
          "13": {
            "Name": "level2Text",
            "NameInSource": "level2Text",
            "Alias": "level2Text",
            "Type": "System.String"
          },
          "14": {
            "Name": "level3AnatomyId",
            "NameInSource": "level3AnatomyId",
            "Alias": "level3AnatomyId",
            "Type": "System.String"
          },
          "15": {
            "Name": "level3Text",
            "NameInSource": "level3Text",
            "Alias": "level3Text",
            "Type": "System.String"
          },
          "16": {
            "Name": "patientFk",
            "NameInSource": "patientFk",
            "Alias": "patientFk",
            "Type": "System.String"
          },
          "17": {
            "Name": "unitFk",
            "NameInSource": "unitFk",
            "Alias": "unitFk",
            "Type": "System.String"
          }
        },
        "NameInSource": "Connection",
        "SqlCommand": "select * from rpt.Wound"
      },
      "9": {
        "Ident": "StiSqlSource",
        "Name": "rpt.WoundState",
        "Alias": "rpt.WoundState",
        "Columns": {
          "0": {
            "Name": "assessmentFk",
            "NameInSource": "assessmentFk",
            "Alias": "assessmentFk",
            "Type": "System.String"
          },
          "1": {
            "Name": "endDate",
            "NameInSource": "endDate",
            "Alias": "endDate",
            "Type": "System.DateTime"
          },
          "2": {
            "Name": "endDateDimDateFk",
            "NameInSource": "endDateDimDateFk",
            "Alias": "endDateDimDateFk",
            "Type": "System.Int32"
          },
          "3": {
            "Name": "id",
            "NameInSource": "id",
            "Alias": "id",
            "Type": "System.String"
          },
          "4": {
            "Name": "isCurrentState",
            "NameInSource": "isCurrentState",
            "Alias": "isCurrentState",
            "Type": "System.Boolean"
          },
          "5": {
            "Name": "patientFk",
            "NameInSource": "patientFk",
            "Alias": "patientFk",
            "Type": "System.String"
          },
          "6": {
            "Name": "startDate",
            "NameInSource": "startDate",
            "Alias": "startDate",
            "Type": "System.DateTime"
          },
          "7": {
            "Name": "startDateDimDateFk",
            "NameInSource": "startDateDimDateFk",
            "Alias": "startDateDimDateFk",
            "Type": "System.Int32"
          },
          "8": {
            "Name": "unitFk",
            "NameInSource": "unitFk",
            "Alias": "unitFk",
            "Type": "System.String"
          },
          "9": {
            "Name": "woundFk",
            "NameInSource": "woundFk",
            "Alias": "woundFk",
            "Type": "System.String"
          },
          "10": {
            "Name": "woundStateTypeFk",
            "NameInSource": "woundStateTypeFk",
            "Alias": "woundStateTypeFk",
            "Type": "System.String"
          }
        },
        "NameInSource": "Connection",
        "SqlCommand": "select * from rpt.WoundState"
      },
      "10": {
        "Ident": "StiSqlSource",
        "Name": "rpt.WoundStateType",
        "Alias": "rpt.WoundStateType",
        "Columns": {
          "0": {
            "Name": "attributeLookupKey",
            "NameInSource": "attributeLookupKey",
            "Alias": "attributeLookupKey",
            "Type": "System.String"
          },
          "1": {
            "Name": "id",
            "NameInSource": "id",
            "Alias": "id",
            "Type": "System.String"
          },
          "2": {
            "Name": "isActive",
            "NameInSource": "isActive",
            "Alias": "isActive",
            "Type": "System.Boolean"
          },
          "3": {
            "Name": "name",
            "NameInSource": "name",
            "Alias": "name",
            "Type": "System.String"
          }
        },
        "NameInSource": "Connection",
        "SqlCommand": "select * from rpt.WoundStateType"
      },
      "11": {
        "Ident": "StiSqlSource",
        "Name": "weekly_data",
        "Alias": "weekly_data",
        "Key": "263f454d21eb17c48dbbabd367be8fa4",
        "Columns": {
          "0": {
            "Name": "Year",
            "NameInSource": "Year",
            "Alias": "Year",
            "Type": "System.Int32"
          },
          "1": {
            "Name": "Week",
            "NameInSource": "Week",
            "Alias": "Week",
            "Type": "System.Int32"
          },
          "2": {
            "Name": "UserName",
            "NameInSource": "UserName",
            "Alias": "UserName",
            "Type": "System.String"
          },
          "3": {
            "Name": "Assessments",
            "NameInSource": "Assessments",
            "Alias": "Assessments",
            "Type": "System.Int32"
          },
          "4": {
            "Name": "Wounds",
            "NameInSource": "Wounds",
            "Alias": "Wounds",
            "Type": "System.Int32"
          },
          "5": {
            "Name": "Patients",
            "NameInSource": "Patients",
            "Alias": "Patients",
            "Type": "System.Int32"
          },
          "6": {
            "Name": "WeekStartDate",
            "NameInSource": "WeekStartDate",
            "Alias": "WeekStartDate",
            "Type": "System.DateTime"
          }
        },
        "NameInSource": "Connection",
        "SqlCommand": "WITH YearRange AS (\n    SELECT \n        MIN(DATEPART(YEAR, d.date)) AS EarliestYear, \n        MAX(DATEPART(YEAR, d.date)) AS LatestYear\n    FROM \n        rpt.dimdate d\n    WHERE \n        d.id = (SELECT MIN(a.dimDateFk) FROM rpt.assessment a)\n)\n\n-- Step 2: Generate week series using CTEs\n, WeekSeries AS (\n    SELECT \n        DATEPART(WEEK, d.date) AS Week,\n        DATEADD(DAY, 1 - DATEPART(WEEKDAY, d.date), d.date) AS WeekStartDate  -- Calculate the start date of each week\n    FROM \n        rpt.dimdate d\n    CROSS JOIN YearRange yr -- Join with YearRange CTE\n    WHERE \n        DATEPART(YEAR, d.date) BETWEEN yr.EarliestYear AND yr.LatestYear\n    GROUP BY \n        DATEPART(WEEK, d.date), DATEADD(DAY, 1 - DATEPART(WEEKDAY, d.date), d.date)  -- Group by week number and week start date\n)\n\n-- Step 3: Get all users\n, AllUsers AS (\n    SELECT DISTINCT \n        a.createdByUserName\n    FROM \n        rpt.assessment a\n)\n\n-- Step 4: Generate week-user combinations\n, WeekUserCombination AS (\n    SELECT \n        ws.Week,\n        -- Extract the year from the WeekStartDate\n        DATEPART(YEAR, ws.WeekStartDate) AS Year,  -- Year is derived from WeekStartDate\n        ws.WeekStartDate,  -- Include the WeekStartDate\n        au.createdByUserName AS UserName\n    FROM \n        WeekSeries ws\n    CROSS JOIN \n        AllUsers au\n)\n\n-- Step 5: Aggregate weekly data\n, WeeklyData AS (\n    SELECT \n        DATEPART(YEAR, a.date) AS Year,\n        DATEPART(WEEK, a.date) AS Week,\n        a.createdByUserName AS UserName,\n        COUNT(DISTINCT CASE \n                          WHEN atv.name = 'Wound Assessment' THEN a.id \n                          ELSE NULL \n                      END) AS AssessmentCount,\n        COUNT(DISTINCT a.woundFk) AS WoundCount,\n        COUNT(DISTINCT a.patientFk) AS PatientCount\n    FROM \n        rpt.assessment a\n    INNER JOIN \n        rpt.AssessmentTypeVersion atv\n        ON a.assessmentTypeVersionFk = atv.id\n    WHERE \n        DATEPART(YEAR, a.date) BETWEEN (SELECT EarliestYear FROM YearRange) AND (SELECT LatestYear FROM YearRange)\n    GROUP BY \n        DATEPART(YEAR, a.date), DATEPART(WEEK, a.date), a.createdByUserName\n)\n\n-- Step 6: Combine data\nSELECT \n    wuc.Year,\n    wuc.Week,\n    wuc.UserName,\n    ISNULL(wd.AssessmentCount, 0) AS 'Assessments',\n    ISNULL(wd.WoundCount, 0) AS 'Wounds',\n    ISNULL(wd.PatientCount, 0) AS 'Patients',\n    wuc.WeekStartDate  -- Include the week start date\nFROM \n    WeekUserCombination wuc\nLEFT JOIN \n    WeeklyData wd\n    ON wuc.Year = wd.Year \n    AND wuc.Week = wd.Week \n    AND wuc.UserName = wd.UserName\nORDER BY \n    wuc.Year, wuc.Week, wuc.UserName;\n"
      }
    },
    "Databases": {
      "0": {
        "Ident": "StiSqlDatabase",
        "Name": "Connection",
        "Alias": "Connection",
        "ConnectionStringEncrypted": "ng=="
      }
    }
  },
  "Pages": {
    "0": {
      "Ident": "StiDashboard",
      "Name": "Dashboard_Page",
      "Guid": "338e76b898a87e6d582f7a7c878a400b",
      "Interaction": {
        "Ident": "StiInteraction"
      },
      "Brush": "solid:51,51,102",
      "Components": {
        "0": {
          "Ident": "StiChartElement",
          "Name": "ChartElement1",
          "Guid": "30fed9202e59e5166e150f52e5ca911c",
          "ClientRectangle": "60,120,1100,460",
          "Interaction": {
            "Ident": "StiInteraction"
          },
          "Border": ";;;;",
          "BackColor": "245,245,245",
          "Values": {
            "0": {
              "Ident": "ValueChartMeter",
              "Key": "cab095e7843fcdb8ab0dc4199663923a",
              "Expression": "Sum(weekly_data.Wounds)",
              "Label": "Wounds"
            },
            "1": {
              "Ident": "ValueChartMeter",
              "Key": "0b933382dad2f3c8766487292967fa74",
              "Expression": "Sum(weekly_data.Patients)",
              "Label": "Patients"
            }
          },
          "Arguments": {
            "0": {
              "Ident": "ArgumentChartMeter",
              "Key": "683b00664a6ec39d8a66e2ae3f646be3",
              "Expression": "weekly_data.WeekStartDate",
              "Label": "WeekStartDate"
            }
          },
          "DashboardInteraction": {
            "Ident": "Chart",
            "OnHover": "ShowToolTip",
            "OnClick": "ApplyFilter",
            "HyperlinkDestination": "NewTab"
          },
          "Title": {
            "Text": "Chart",
            "Visible": false
          },
          "ManuallyEnteredChartMeter": {
            "Ident": "ValueChartMeter",
            "Key": "b511a766bb327e683471bf6cd35e45d4"
          },
          "ArgumentFormat": {
            "Ident": "StiGeneralFormatService"
          },
          "ValueFormat": {
            "Ident": "StiGeneralFormatService"
          },
          "XAxis": {
            "Labels": {
              "Color": "51,51,102"
            },
            "Title": {
              "Color": "51,51,102",
              "Visible": false
            },
            "ShowEdgeValues": "False"
          },
          "YAxis": {
            "Title": {
              "Text": "Count",
              "Color": "51,51,102"
            }
          },
          "Legend": {
            "Labels": {
              "Font": ";12;;",
              "Color": "51,51,102"
            },
            "HorAlignment": "Center"
          },
          "Area": {
            "SideBySide": true,
            "GridLinesHor": {
              "Color": "Transparent"
            },
            "GridLinesVert": {
              "Color": "Transparent"
            },
            "InterlacingHor": {
              "Color": "230,230,230",
              "Visible": true
            },
            "InterlacingVert": {
              "Color": "Transparent"
            },
            "Indicator": {
              "Title": {
                "Text": ""
              }
            }
          },
          "Labels": {
            "ForeColor": "255,255,255",
            "Position": "None"
          },
          "Options3D": {
            "Opacity": 1,
            "Lighting": "Gradient"
          },
          "SeriesColors": {
            "0": "102,26,148",
            "1": "51,153,204"
          },
          "CornerRadius": "10, 10, 10, 10",
          "Shadow": ";;;"
        },
        "1": {
          "Ident": "StiComboBoxElement",
          "Name": "ComboBoxElement1",
          "Guid": "fec8b876f7f674a73d96e05be88d19e4",
          "ClientRectangle": "360,80,220,40",
          "Interaction": {
            "Ident": "StiInteraction"
          },
          "Border": ";;;;",
          "BackColor": "245,245,245",
          "ForeColor": "51,51,102",
          "Font": ";14;Bold;",
          "ShowAllValue": true,
          "SelectionMode": "Multi",
          "KeyMeter": {
            "Ident": "KeyComboBoxMeter",
            "Key": "7204c803347e3da7745a2584086739b4",
            "Expression": "weekly_data.UserName",
            "Label": "UserName"
          },
          "CornerRadius": "10, 10, 0, 0",
          "Shadow": ";;;",
          "DashboardInteraction": {
            "Ident": "Filter",
            "OnHover": "ShowToolTip",
            "OnClick": "ApplyFilter",
            "HyperlinkDestination": "NewTab"
          }
        },
        "2": {
          "Ident": "StiTextElement",
          "Name": "TextElement1",
          "Guid": "b2665cc8e1891f7e78907ca173ef06f3",
          "ClientRectangle": "280,80,80,40",
          "Interaction": {
            "Ident": "StiInteraction"
          },
          "Border": ";;;;",
          "BackColor": "245,245,245",
          "DashboardInteraction": {
            "Ident": "Text",
            "OnHover": "ShowToolTip",
            "OnClick": "OpenHyperlink",
            "HyperlinkDestination": "NewTab"
          },
          "ForeColor": "51,51,102",
          "Text": "<font face=\"Arial\" size=\"14\" ><text-align=\"Center\"><b><font-color=\"#333366\">User:</font-color></b></text-align></font>",
          "CornerRadius": "10, 10, 0, 0",
          "Shadow": ";;;",
          "Title": {
            "Text": "Text",
            "Visible": false
          }
        },
        "3": {
          "Ident": "StiTextElement",
          "Name": "TextElement2",
          "Guid": "a97aa604bf15dfbccaafa9057d1ad45d",
          "ClientRectangle": "280,0,640,60",
          "Interaction": {
            "Ident": "StiInteraction"
          },
          "Border": ";;;;",
          "BackColor": "245,245,245",
          "DashboardInteraction": {
            "Ident": "Text",
            "OnHover": "ShowToolTip",
            "OnClick": "OpenHyperlink",
            "HyperlinkDestination": "NewTab"
          },
          "Text": "<font face=\"Arial\" size=\"22\"><text-align=\"center\"><b>User Activity Overview</b></text-align=\"center\"></font>",
          "CornerRadius": "10, 10, 10, 10",
          "Shadow": ";;;",
          "Title": {
            "Text": "Text",
            "Visible": false
          }
        },
        "4": {
          "Ident": "StiComboBoxElement",
          "Name": "ComboBoxElement2",
          "Guid": "21388e6f905d7b68ef07a0e88543a11b",
          "ClientRectangle": "740,80,180,40",
          "Interaction": {
            "Ident": "StiInteraction"
          },
          "Border": ";;;;",
          "InitialValue": "2024",
          "Font": ";12;Bold;",
          "KeyMeter": {
            "Ident": "KeyComboBoxMeter",
            "Key": "02f4eed8c1a5b3a15feb4ac3246fba0e",
            "Expression": "weekly_data.Year",
            "Label": "Year"
          },
          "CornerRadius": "10, 10, 0, 0",
          "Shadow": ";;;",
          "DashboardInteraction": {
            "Ident": "Filter",
            "OnHover": "ShowToolTip",
            "OnClick": "ApplyFilter",
            "HyperlinkDestination": "NewTab"
          }
        },
        "5": {
          "Ident": "StiTextElement",
          "Name": "TextElement3",
          "Guid": "850ef6b0a1e1c973827af293e1e5971c",
          "ClientRectangle": "660,80,80,40",
          "Interaction": {
            "Ident": "StiInteraction"
          },
          "Border": ";;;;",
          "BackColor": "245,245,245",
          "DashboardInteraction": {
            "Ident": "Text",
            "OnHover": "ShowToolTip",
            "OnClick": "OpenHyperlink",
            "HyperlinkDestination": "NewTab"
          },
          "ForeColor": "51,51,102",
          "Text": "<font face=\"Arial\" size=\"14\"><text-align=\"center\"><b><font color=\"#333366\">Year:</font></b></text-align=\"center\"></font>",
          "CornerRadius": "10, 10, 0, 0",
          "Shadow": ";;;",
          "Title": {
            "Text": "Text",
            "Visible": false
          }
        }
      },
      "Watermark": {
        "TextBrush": "solid:50,0,0,0"
      },
      "Style": "AliceBlue",
      "Border": ";;2;;;;;solid:Black",
      "BackColor": "51,51,102"
    }
  }
}